---
description: Guidelines for developing on the Django Project Template itself (not a generated project)
globs: project_name/**/*.py-tpl,dev/**/*,AGENTS.md
alwaysApply: false
---

# Template Development Rules

This rule applies when working on the **template repository itself**, not a project generated from it.

## Critical: Template Variables

- The string `{{ project_name }}` is a Django template variable. **DO NOT** replace it with a real name.
- `{% templatetag openvariable %}` and `{% templatetag closevariable %}` are valid Django template tags. **DO NOT** "fix" them.
- Files ending in `.py-tpl` are Python files that will be renamed to `.py` during project generation. Treat them as Python code but respect embedded template tags.

## File Structure

- Source code lives in `project_name/project_name/` (double nesting is intentional).
- Frontend source lives in `frontend/project_name/`.
- The `dev/` folder contains tools for testing the template and is excluded from generated projects.

## Testing Template Changes

Always test changes by generating a new project:

```bash
uv run ansible-playbook ./dev/01-test-project-template.yaml
```

This will:

1. Generate a project in a temporary directory.
2. Install dependencies.
3. Run migrations and basic checks.

## Finding Hardcoded `project_name`

Use this command to find `project_name` that is NOT a template variable (and needs fixing):

```bash
rg 'project_name' | rg -v '\{\{\s*project_name\s*\}\}'
```

## When Adding New Files

- Place Python files in `project_name/project_name/<app>/` with `.py-tpl` extension.
- Use `{{ project_name }}` for imports and references.
- Add new file extensions to the `--extension` flag in `README.md` if needed.
